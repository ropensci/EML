---
layout: software

---


<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{An Introduction to the EML package}
-->

[![Build Status](https://travis-ci.org/ropensci/EML.svg)](https://travis-ci.org/ropensci/EML)

About
=====

`EML` is an R package for reading, writing, integrating and publishing data using 
the Ecological Metadata Language (EML) format.

* **Note:** This package is still in active development and not yet submitted
  to CRAN.  Functions and documentation may be incomplete and subject to
  change.
* Maintainer: Carl Boettiger
* Authors: Carl Boettiger, Claas-Thido Pfaff, Duncan Temple Lang, Karthik Ram,
           Matt Jones
* License: [CC0](http://creativecommons.org/publicdomain/zero/1.0/)
* [Issues](https://github.com/ropensci/EML/issues): 
  Bug reports, feature requests, and development discussion.


_This is a dynamic document, generated by [knitr](http://yihui.name/knitr) 
using [README.Rmd](https://github.com/ropensci/EML/blob/master//vingettes/README.Rmd) 
as the source._





Installation
============

Install the R package:



```r
library("devtools")
install_github("ropensci/EML", build=FALSE, dependencies=c("DEPENDS", "IMPORTS"))
```

The additional arguments avoid installing packages that are suggested for use in some advanced examples but not needed for the basic functionality. We can now load the package:


```r
library("EML")
```


Usage
=====


Writing R data into EML
-----------------------


Consider a standard data frame in R:


```r
dat <- data.frame(river = factor(c("SAC",  
                                   "SAC",   
                                   "AM")),
                  spp   = c("Oncorhynchus tshawytscha",  
                            "Oncorhynchus tshawytscha", 
                            "Oncorhynchus kisutch"),
                  stg   = ordered(c("smolt", 
                                    "parr", 
                                    "smolt"), 
                                  levels=c("parr", 
                                           "smolt")), # => parr < smolt
                  ct    = c(293L,    
                            410L,    
                            210L),
                  day   = as.Date(c("2013-09-01", 
                                    "2013-09-1", 
                                    "2013-09-02")),
                  stringsAsFactors = FALSE)
```


|  river  |           spp            |  stg  |  ct  |    day     |
|:-------:|:------------------------:|:-----:|:----:|:----------:|
|   SAC   | Oncorhynchus tshawytscha | smolt | 293  | 2013-09-01 |
|   SAC   | Oncorhynchus tshawytscha | parr  | 410  | 2013-09-01 |
|   AM    |   Oncorhynchus kisutch   | smolt | 210  | 2013-09-02 |


Note that we have taken care to get the column classes right.


Like many real data sets, the column headings are convenient for data
entry and manipulation, but not particularly descriptive to a user not
already familiar with this data. More important still, they don't let
us know what units they are measured in (or in the case of categorical
/ factor data like species names or life stages, what the factor
abbreviations refer to).  So let us take a moment to be more explicit:


```r
col.defs <- c("River site used for collection",
              "Species scientific name",
              "Life Stage", 
              "count of live fish in traps",
              "The day on which traps were sampled")


unit.defs <- list(
  c(SAC = "The Sacramento River",     # Factor 
    AM = "The American River"),
 "Scientific name",                   # Character string 
  c(parr = "third life stage",        # Ordered factor 
    smolt = "fourth life stage"),
  c(unit = "number", 
    precision = 1, 
    bounds = c(0, Inf)),              # Integer
  c(format = "YYYY-MM-DD",            # Date
    precision = 1))
```

Note that we are careful to enter these in the order of the columns given. <!-- Otherwise, we should name the elements using the corresponding column header names.  -->

`col.defs` are relatively self explanatory, but `unit.defs` can be a little tricky.  

- For `factors`, this is a definition of the levels involved, as shown.  
- For `numeric` data, you must specify the units from [this list](https://knb.ecoinformatics.org/#external//emlparser/docs/eml-2.1.1/./eml-unitTypeDefinitions.html#StandardUnitDictionary), or [define a custom unit](# "tutorial coming soon").  Optionally you can express the precision and bounds of the unit as well.  
- For `Dates` or times, specify the format, (e.g. YYYY or MM-DD-YY). Optionally you can also express the precision.  
- For character strings, a definition of the kind of string can be given, or otherwise the column description will be used.

With this information in place, we just about have all the required
metadata to generate a minimally valid EML file documenting this
dataset. We just need to also specify a default creator who will also
be used as the contact person for EML files created in this session,
including a contact address in angle brackets, and we are good to go:




```r
eml_write(dat, 
          col.defs = col.defs, 
          unit.defs = unit.defs, 
          creator = "Carl Boettiger <cboettig@ropensci.org>", 
          file = "EML_example.xml")
```

```
[1] "EML_example.xml"
```

*for convenience, if had we omitted `col.defs` and `unit.defs`, 
`EML` will launch its metadata wizard to assist in constructing the
metadata based on the data.frame provided*.  While this may be helpful
starting out, regular users will find it faster to define the columns
and units directly in the format above.

See the [EML generated](https://github.com/ropensci/EML/tree/master/inst/examples/EML_example.xml)
by this example.


We can validate the resulting document to check that no required
fields are missing and that no entry has been incorrectly formatted.
This ensures that other software can correctly parse and interpret the
metadata document:


```r
eml_validate("EML_example.xml") 
```

```
EML specific tests XML specific tests 
              TRUE               TRUE 
```



* See [Open issues in writing EML](https://github.com/ropensci/EML/issues?labels=write+eml&page=1&state=open)

Publish EML
-----------

Once we have generated a basic EML file, we can publish it to a variety
of academic repositories where it will be indexed, permenently archived,
more easily citable, and publicly discoverable.


### Publishing to figshare

In this example, we will publish the above
EML to [figshare](http://figshare.com) using the
[rfigshare](https://github.com/ropensci/rfigshare) package. Like most
academic repostories, figshare requires some basic metadata for any entry.
Much of this we can automatically extract from our existing EML file.
Additional metadata unique to figshare (e.g. matching it's allowed "categories"
can also be provided.

_Note: this example assumes `rfigshare` is installed, even though it is not
required to use EML and run the examples in the other sections.  See the
`rfigshare` documentation for authenticating `rfigshare` with your user account_

<!-- We don't want to generate a DOI every time we run the vignette -->


```r
eml_publish("EML_example.xml", 
            description="Example EML file from EML",
            categories = "Ecology", 
            tags = "EML", 
            destination="figshare") 
```

```
[1] 1115123
```

This creates a draft file visible only to the user configured in
`rfigshare`.  The document can be made (permanently) public using
either the figshare web interface, the `rfigshare` package (using
`fs_make_public(id)`) or just by adding the argument `visibility = TRUE`
to the above `eml_publish` command.


#### In development

See [Open issues in publishing EML](https://github.com/ropensci/EML/issues?labels=publish+eml&page=1&state=open)


Parsing and exploring an EML file
----------------------------------

Users will not only want to generate EML files, but also take advantage of
the wealth of data already well documented in EML.  The package provides
many tools to facilitate the extraction of data from EML files into
their native R formats, as well as utilities to access and manipulate
the metadata provided. By having these tools avialble in the scripted R
environment, it becomes possible to write functions that can be easily
applied across large collections of files. In this way, researchers
can scale their analyses across ever larger collections of datasets by
automating the more tedious aspects of data discovery and integration.



```r
obj <- eml_read("EML_example.xml")
```

We can also read in a remote file by providing a URL or KNB object identifier (such as a DOI).


The `eml_get` function provides us with easy access to many of the
component elements of the metadata file.  See the documentation for a
complete list.


```r
dat <- eml_get(obj, "data.frame")
```


```r
eml_get(obj, "contact")
```

```
[1] "Carl Boettiger <cboettig@ropensci.org>"
```


```r
eml_get(obj, "citation_info")
```

```
Boettiger C (2014-07-22). _metadata_.
```



Advanced writing of EML
-----------------------

**IN PROGRESS**

Our minimal EML file barely scratches the surface of what is possible
to do with EML.  In [Advanced writing of EML](https://github.com/ropensci/EML/blob/master//vignettes/Advanced_writing_of_EML.md), we construct a much
richer EML file, including:

- Constructing more complete lists of authors, publishers and contact.
- Summarizing the geographic, temporal, and taxonomic coverage of the dataset
- Reading in pages of methods descriptions from a Word document
- Adding arbitrary additional metadata
- Indicating the canonical citation to the paper that should be acknowledged
  when the data is re-used.
- Conversion between EML and other metadata formats, such as NCBII and ISO
  standards.

In so doing we will take a more modular approach that will allow us to
build up our metadata from reusable components, while also providing a
more fine-grained control over the resulting output fields and files.


Advanced parsing and manipulation of EML
----------------------------------------

**IN PROGRESS**

In [Advanced parsing and manipulation of EML](https://github.com/ropensci/EML/blob/master//vignettes/Advanced_parsing_of_EML.md), we

- Introduce how to access any EML element in R using the S4 subsetting mechanism
- Demonstrate how to extract and manipulate semantic RDF triples from EML
  metadata
- Illustrate how EML metadata extraction can be applied across a collection
  of files
- Illustrate how EML manipulation can be combined with queries across even
  larger distributed collections of EML data over the dataone network
- Demonstrate merging of multiple datasets based on semantics




Testing and development
-----------------------

The advanced vignettes include some cutting edge functionality that depends on additional packages are not yet on CRAN and may not be stable.  To take advantage of these functions when indicated in the tutorial, consider installing the following packages:

<!-- Not working
```r
install_github("Sxslt", "omegahat")
install_github("XMLSchema", "omegahat")
install_github("RHTMLForms", "omegahat")
```
-->



```r
library("devtools")
install_github("RWordXML", "duncantl") 
install.packages("Sxslt", repos="http://www.omegahat.org/R", type="source")
install.packages("RHTMLForms", repos="http://www.omegahat.org/R", type="source")
install.packages("XMLSchema", repos="http://www.omegahat.org/R", type="source")

```

Successful installation of these packages will require the `devtools`
package (for `install_github`) and the ability to build packages from
source.



License
=======

See [LICENSE](http://github.com/ropensci/EML/blob/master/LICENSE)


Support
=======

***Suggestions, feature requests, bug reports, pull requests and 
other feedback welcome!*** Please see our [issues
tracker](https://github.com/ropensci/EML/issues)

Interested in contributing to the package? Want to know more about how the project is organized? Please see our [contributing](http://github.com/ropensci/EML/blob/master/CONTRIBUTING.md) guidelines. 

[![ropensci footer](http://ropensci.org/public_images/github_footer.png)](http://ropensci.org)
